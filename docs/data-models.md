# Data Models & Signal Maps

## Memory Map (Macintosh View)

When the Mac accesses the FPGA as a slave, it uses the following slot spaces.

| Slot | Address Range | Mapped To |
| :--- | :--- | :--- |
| Slot 9 | `0xF900 0000` - `0xF9FF FFFF` | SoC Wishbone Bus |
| Slot A | `0xFA00 0000` - `0xFAFF FFFF` | SoC Wishbone Bus |
| Slot B | `0xFB00 0000` - `0xFBFF FFFF` | SoC Wishbone Bus |

*Note: The current gateware maps all these slots to the same internal bus logic.*

## SoC Memory Map (Internal)

The internal Wishbone bus map (generated by LiteX):

| Peripheral | Base Address | Size |
| :--- | :--- | :--- |
| SRAM | `0x0000 0000` | 8 KB (0x2000) |
| CSRs | `0x8200 0000` | Variable |

*(Consult the generated `csr.csv` or `mem.sv` after build for exact offsets)*

## PDS Signal Mapping

The `ztex213_se30.py` file defines the pinout. This mapping repurposes the ZTex interface board's NuBus and HDMI pins.

### Address & Data

| Signal | Description | ZTex Pin / Source |
| :--- | :--- | :--- |
| `pds_a_3v3_n` | Address Bus [31:0] | Original `ad` pins |
| `pds_d_3v3_n` | Data Bus [31:0] | `tm0-2`, `id`, `arb`, `ack`, `start`, `P1` header, etc. |

### Control Signals

| Signal | Function | Pin | Note |
| :--- | :--- | :--- | :--- |
| `/AS` | Address Strobe | `J13` | Was `arbcy_n` |
| `/DS` | Data Strobe | `G13` | Was `nubus_oe` |
| `R/W` | Read/Write | `G16` | Was `nubus_ad_dir` |
| `/DSACK0` | Data Strobe Ack 0 | `H15` | Was `grant` |
| `/DSACK1` | Data Strobe Ack 1 | `H14` | Was `fpga_to_cpld_clk` |
| `SIZ0` | Size Bit 0 | `U6` | Was `tmoen` |
| `SIZ1` | Size Bit 1 | `J14` | Was `fpga_to_cpld_signal` |
| `/BERR` | Bus Error | `J16` | Was `tm1_o_n` |

### Arbitration & Interrupts

| Signal | Function | Pin | Note |
| :--- | :--- | :--- | :--- |
| `/BR` | Bus Request | `R6` | |
| `/BG` | Bus Grant | `R7` | |
| `/BGACK` | Bus Grant Ack | `R8` | |
| `/IRQx` | Interrupts 1-3 | `U8`, `K13`, `J15` | |
